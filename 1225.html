<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç°¡æ˜“ 3x3 æ‹¼åœ–éŠæˆ²</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f2f5;
        }

        h1 {
            color: #333;
            margin-bottom: 20px;
        }

        /* éŠæˆ²å®¹å™¨ï¼šè¨­å®šç¶²æ ¼ä½ˆå±€ */
        #game-board {
            display: grid;
            grid-template-columns: repeat(3, 100px); /* 3æ¬„ï¼Œæ¯æ¬„100px */
            grid-template-rows: repeat(3, 100px);    /* 3åˆ—ï¼Œæ¯åˆ—100px */
            gap: 2px; /* æ–¹å¡Šä¹‹é–“çš„é–“è· */
            background-color: #333;
            border: 5px solid #333;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        /* æ‹¼åœ–æ–¹å¡Šæ¨£å¼ */
        .tile {
            width: 100px;
            height: 100px;
            cursor: pointer;
            position: relative;
            background-image: url('https://img.funto.in/uploads/shops/660/products/d2/d24ee09f92feef92f173ae74bf648d3e.jpg?v=0'); /* åœ–ç‰‡ä¾†æº */
            background-repeat: no-repeat;
            transition: transform 0.2s, opacity 0.2s;
        }

        /* ç•¶æ»‘é¼ ç§»ä¸Šå»çš„æ•ˆæœ */
        .tile:hover {
            opacity: 0.8;
        }

        /* è¢«é¸ä¸­æ™‚çš„æ¨£å¼ (æº–å‚™äº¤æ›) */
        .selected {
            border: 3px solid #ffeb3b; /* é»ƒè‰²é‚Šæ¡† */
            z-index: 10;
            box-sizing: border-box;
            transform: scale(0.95);
        }

        /* æŒ‰éˆ•æ¨£å¼ */
        #shuffle-btn {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 16px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        #shuffle-btn:hover {
            background-color: #0056b3;
        }
        
        #message {
            margin-top: 15px;
            color: green;
            font-weight: bold;
            height: 20px;
        }
    </style>
</head>
<body>

    <h1>ğŸ§© æ‹¼åœ–æŒ‘æˆ°</h1>
    
    <div id="game-board"></div>
    
    <div id="message"></div>
    <button id="shuffle-btn" onclick="initGame()">é‡æ–°æ´—ç‰Œ</button>

    <script>
        const board = document.getElementById('game-board');
        const messageDiv = document.getElementById('message');
        let tiles = []; // å„²å­˜ç›®å‰çš„æ‹¼åœ–é †åº
        let selectedTileIndex = null; // è¨˜éŒ„ç¬¬ä¸€æ¬¡é»æ“Šçš„æ–¹å¡Šç´¢å¼•

        // ç”¢ç”Ÿæ­£ç¢ºçš„é †åºé™£åˆ— [0, 1, 2, ... 8]
        // é€™äº›æ•¸å­—ä»£è¡¨åœ–ç‰‡çš„ã€Œåˆ‡ç‰‡ä½ç½®ã€
        const correctOrder = [0, 1, 2, 3, 4, 5, 6, 7, 8];

        // åˆå§‹åŒ–éŠæˆ²
        function initGame() {
            // è¤‡è£½ä¸€ä»½æ­£ç¢ºé †åºä¾†é€²è¡Œæ´—ç‰Œ
            tiles = [...correctOrder]; 
            
            // éš¨æ©Ÿæ‰“äº‚é™£åˆ— (Shuffle)
            for (let i = tiles.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [tiles[i], tiles[j]] = [tiles[j], tiles[i]];
            }

            messageDiv.innerText = "";
            selectedTileIndex = null;
            renderBoard();
        }

        // æ¸²æŸ“ç•«é¢ (å°‡é™£åˆ—è½‰æ›æˆ HTML å…ƒç´ )
        function renderBoard() {
            board.innerHTML = ''; // æ¸…ç©ºç›®å‰çš„ç•«é¢

            tiles.forEach((tileValue, index) => {
                const tileDiv = document.createElement('div');
                tileDiv.classList.add('tile');
                
                // è¨­å®šèƒŒæ™¯ä½ç½®çš„æ ¸å¿ƒé‚è¼¯ï¼
                // æ ¹æ“š tileValue (åœ–ç‰‡åŸæœ¬çš„ä½ç½®) ä¾†æ±ºå®šé¡¯ç¤ºåœ–ç‰‡çš„å“ªä¸€éƒ¨åˆ†
                const row = Math.floor(tileValue / 3);
                const col = tileValue % 3;
                
                // backgroundPositionX æ˜¯è² çš„ col * 100px
                // backgroundPositionY æ˜¯è² çš„ row * 100px
                tileDiv.style.backgroundPosition = `-${col * 100}px -${row * 100}px`;

                // ç¶å®šé»æ“Šäº‹ä»¶
                tileDiv.onclick = () => handleTileClick(index);

                // å¦‚æœé€™å€‹æ–¹å¡Šæ˜¯è¢«é¸ä¸­çš„ï¼ŒåŠ ä¸Šæ¨£å¼
                if (index === selectedTileIndex) {
                    tileDiv.classList.add('selected');
                }

                board.appendChild(tileDiv);
            });
        }

        // è™•ç†é»æ“Šé‚è¼¯
        function handleTileClick(index) {
            // æƒ…æ³ä¸€ï¼šé‚„æ²’é¸éä»»ä½•æ–¹å¡Š
            if (selectedTileIndex === null) {
                selectedTileIndex = index;
                renderBoard(); // é‡æ–°æ¸²æŸ“ä»¥é¡¯ç¤ºé»ƒè‰²æ¡†æ¡†
                return;
            }

            // æƒ…æ³äºŒï¼šé»æ“Šäº†åŒä¸€å€‹æ–¹å¡Š (å–æ¶ˆé¸å–)
            if (selectedTileIndex === index) {
                selectedTileIndex = null;
                renderBoard();
                return;
            }

            // æƒ…æ³ä¸‰ï¼šå·²ç¶“é¸äº†ä¸€å€‹ï¼Œç¾åœ¨é»äº†ç¬¬äºŒå€‹ -> äº¤æ›ä½ç½® (Swap)
            swapTiles(selectedTileIndex, index);
            selectedTileIndex = null; // é‡ç½®é¸å–ç‹€æ…‹
            renderBoard();
            
            // æ¯æ¬¡äº¤æ›å¾Œæª¢æŸ¥æ˜¯å¦å‹åˆ©
            checkWin();
        }

        // äº¤æ›é™£åˆ—ä¸­çš„å…©å€‹å…ƒç´ 
        function swapTiles(index1, index2) {
            const temp = tiles[index1];
            tiles[index1] = tiles[index2];
            tiles[index2] = temp;
        }

        // æª¢æŸ¥æ˜¯å¦å®Œæˆ
        function checkWin() {
            // å°‡ç›®å‰çš„ tiles é™£åˆ—è½‰æˆå­—ä¸²ï¼Œè·Ÿæ­£ç¢ºç­”æ¡ˆæ¯”å°
            if (tiles.toString() === correctOrder.toString()) {
                messageDiv.innerText = "ğŸ‰ æ­å–œå®Œæˆï¼ä½ å¤ªå²å®³äº†ï¼";
                // ç¨å¾®å»¶é²ä¸€é»å†è·³å‡ºè¦–çª—ï¼Œè®“ç©å®¶çœ‹åˆ°æœ€å¾Œä¸€å¡Šæ­¸ä½
                setTimeout(() => alert('æ­å–œå®Œæˆæ‹¼åœ–ï¼æŠ˜æ‰£ç¢¼:251225'), 100);
            }
        }

        // ç¶²é è¼‰å…¥æ™‚ç›´æ¥é–‹å§‹éŠæˆ²
        initGame();

    </script>
</body>
</html>
